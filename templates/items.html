<!DOCTYPE html>
<html>
<head><meta charset="utf-8"/><title>Items List</title></head>
<body>
  <h1>アイテム一覧</h1>

  <!-- 新規アイテム登録フォーム -->
  <h2>アイテム新規登録</h2>
  <form method="POST">
    <div>
      <label>名前:</label>
      <input type="text" name="name" required/>
    </div>
    <div>
      <label>カテゴリ:</label>
      <input type="text" name="category" />
    </div>
    <div>
      <label>商品リンク:</label>
      <input type="text" name="productLink" />
    </div>
    <button type="submit">登録</button>
  </form>

  <hr/>
  <h2>登録済みアイテム</h2>
  {% if items_with_usage %}
    <ul>
      {% for data in items_with_usage %}
        <li>
          <b>{{ data.item.name }}</b> ({{ data.item.category }})
          <a href="{{ data.item.productLink }}">[link]</a>
          <br/>
          利用バージョン:
          {% if data.versions %}
            <ul>
            {% for v in data.versions %}
              <li>{{ v.versionName }} ({{ v.startPeriod }} ~ {{ v.endPeriod }})</li>
            {% endfor %}
            </ul>
          {% else %}
            なし
          {% endif %}
          <form action="{{ url_for('delete_item', item_id=data.item.id) }}" method="POST" style="display:inline;">
            <button type="submit">削除</button>
          </form>
          <a href="{{ url_for('edit_item', item_id=data.item.id) }}">編集</a>
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p>まだアイテムがありません。</p>
  {% endif %}

  <p><a href="{{ url_for('index') }}">トップに戻る</a></p>
</body>
</html>
